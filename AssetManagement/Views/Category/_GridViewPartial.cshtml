@model IList<Data.Entities.Product>
@{
    var grid = Html.DevExpress().GridView(settings =>
    {
        settings.Name = "grid";
        settings.CallbackRouteValues = new
        {
            Controller = "Category",
            Action = "GetProducts",
            categoryId = ViewBag.CategoryId
        };
        settings.SettingsEditing.UpdateRowRouteValues = new
        {
            Controller = "Category",
            Action = "GetProducts",
            categoryId = ViewBag.CategoryId
        };
        settings.SettingsEditing.Mode = GridViewEditingMode.EditForm;
        settings.Width = Unit.Percentage(100);

        settings.KeyFieldName = "ProductID";
        settings.CommandColumn.Visible = true;
        settings.CommandColumn.ShowEditButton = true;
        settings.Columns.Add(c =>
        {
            c.FieldName = "Image";
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.SetDataItemTemplateContent(r =>
            {
                ViewContext.Writer.Write("<img style='height:170px;width:160px' src=\"/Image/Categories/" + HttpUtility.UrlDecode(r.Text) + "\">");

            });
            //            c.EditorProperties().BinaryImage(p =>
            //            {
            //                p.ImageHeight = 170;
            //                p.ImageWidth = 160;
            //                p.EnableServerResize = true;
            //                p.ImageSizeMode = ImageSizeMode.FitProportional;
            //                p.CallbackRouteValues = new { Action = "BinaryImageColumnPhotoUpdate", Controller = "Editing" };
            //                p.EditingSettings.Enabled = true;
            //                p.EditingSettings.UploadSettings.UploadValidationSettings.MaxFileSize = 4194304;
            //            });
        });
        settings.Columns.Add("ProductName");
        settings.Columns.Add("Description");
        settings.Columns.Add("Brand");

        settings.EditFormLayoutProperties.ColCount = 3;
        settings.EditFormLayoutProperties.Items.Add(i =>
        {
            i.ColumnName = "Image";
            i.RowSpan = 4;
            i.ShowCaption = DefaultBoolean.False;
            i.Width = 160;
        });
        settings.EditFormLayoutProperties.Items.Add("ProductName");
        settings.EditFormLayoutProperties.Items.Add("Description");
        settings.EditFormLayoutProperties.Items.Add("Brand");
        settings.EditFormLayoutProperties.Items.AddEmptyItem(new EmptyLayoutItem());
        settings.EditFormLayoutProperties.Items.AddCommandItem(i =>
        {
            i.ShowUpdateButton = true;
            i.ShowCancelButton = true;
            i.HorizontalAlign = FormLayoutHorizontalAlign.Right;
        });

        settings.SettingsPager.PageSize = 3;



    });
}@grid.Bind(Model).GetHtml()